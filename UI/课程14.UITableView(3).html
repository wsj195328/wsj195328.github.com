<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>课程14.UITableView(3)</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><img src="http://static.zybuluo.com/zhuoming/9y9ocj9x0iw2k87m7br254g1/logo.png" width="300" height="100"><span style="float:right;" data-anchor-id="wgb0"><b>求知若渴 求真教育</b></span><div class="md-section-divider"></div><h1 data-anchor-id="ga1b" id="课程14uitableview3">课程14.UITableView(3)</h1><p data-anchor-id="ffuu"><code>iOS</code> <code>UI</code></p><hr><p data-anchor-id="o7y4"><div class="toc"><div class="toc">
<ul>
<li><a href="#课程14uitableview3">课程14.UITableView(3)</a><ul>
<li><a href="#一学习目标">一、学习目标</a></li>
<li><a href="#二课程内容">二、课程内容</a><ul>
<li><a href="#1静态uitableviewcell">1.静态UITableViewCell</a></li>
<li><a href="#2uisearchcontroller">2.UISearchController</a></li>
</ul>
</li>
<li><a href="#三课程作业">三、课程作业</a></li>
</ul>
</li>
</ul>
</div>
</div>
</p><hr><div class="md-section-divider"></div><h2 data-anchor-id="p0tv" id="一学习目标"><strong>一、学习目标</strong></h2><ul data-anchor-id="gjdm">
<li>静态UITableViewCell</li>
<li>UISearchDisplayController使用</li>
</ul><hr><div class="md-section-divider"></div><h2 data-anchor-id="tsti" id="二课程内容"><strong>二、课程内容</strong></h2><div class="md-section-divider"></div><h3 data-anchor-id="p1kv" id="1静态uitableviewcell"><strong>1.静态UITableViewCell</strong></h3><p data-anchor-id="jon0">这节我们用静态的UItableViewCell来完善微信小项目的后两个页面我和发现。注意静态的UITableViewCell只能在UITableViewController中使用，常用与基本不会改变的cell。 <br>
这个是UITableViewController <br>
<img src="http://static.zybuluo.com/zhuoming/qeavneofgs4xya0jvyca9f8q/xib24.png" alt="xib24.png-47kB" title=""> <br>
然后把Cell改成static <br>
<img src="http://static.zybuluo.com/zhuoming/0j9guheufg0j65xqgivvndgw/xib25.png" alt="xib25.png-29.6kB" title=""> <br>
最后往cell里面拖入控件即可 <br>
<img src="http://static.zybuluo.com/zhuoming/3xz4xys2m2neyjako4ss95rj/xib23.png" alt="xib23.png-91.9kB" title=""></p><blockquote data-anchor-id="btr8" class="white-blockquote">
  <p>大家自己动手完善我的页面</p>
</blockquote><p data-anchor-id="3hri">最终的运行效果如下</p><p data-anchor-id="94id"><img src="http://static.zybuluo.com/zhuoming/z5y7dl84gbtpueux70p3sfhf/xib27.png" alt="xib27.png-37.3kB" title=""></p><p data-anchor-id="jfmv"><img src="http://static.zybuluo.com/zhuoming/lbx2n657ec89fk9pjexkg01o/xib27.jpeg" alt="xib27.jpeg-27.4kB" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="p80r" id="2uisearchcontroller"><strong>2.UISearchController</strong></h3><p data-anchor-id="2cpn">UISearchController 是苹果专为 UITableView 搜索封装的一个类。里面内置了一个 UITableView 用于显示搜索的结果。它可以和一个需要搜索功能的controller 关联起来，其它的像原 TableView 和搜索结果 TableView 的切换， mask 的显示等等都封装好了，使用起来非常非常的简单。特别是要实现全屏搜索时使用最多。全屏搜索的意思是如果你用了  NavigationBar 当点击搜索框时 TableView 会自动弹上去覆盖 <br>
NavigationBar，达到一种全屏搜索的效果，这一切 UISearchController 都封装好了，如果自己写就比较麻烦一些。 <br>
<img src="http://static.zybuluo.com/zhuoming/l03yuztapc8kf9ze14vgdlh1/231948577536965.gif" alt="231948577536965.gif-232.9kB" title=""></p><p data-anchor-id="zs6e">所以我们利用UISearchDisplayController把微信的通许录的界面完善。首先我们往UItableView中添加一个UISearchDisplayController。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="urjg"><ol class="linenums"><li class="L0"><code><span class="typ">UISearchController</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> searchC </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[[</span><span class="typ">UISearchController</span><span class="pln"> alloc</span><span class="pun">]</span><span class="pln">initWithSearchResultsController</span><span class="pun">:</span><span class="kwd">nil</span><span class="pun">];</span></code></li><li class="L1"><code><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchC </span><span class="pun">=</span><span class="pln"> searchC</span><span class="pun">;</span></code></li><li class="L2"><code><span class="pun">[</span><span class="pln">searchC</span><span class="pun">.</span><span class="pln">searchBar sizeToFit</span><span class="pun">];</span></code></li><li class="L3"><code><span class="kwd">self</span><span class="pun">.</span><span class="pln">tableView</span><span class="pun">.</span><span class="pln">tableHeaderView </span><span class="pun">=</span><span class="pln"> searchC</span><span class="pun">.</span><span class="pln">searchBar</span><span class="pun">;</span></code></li><li class="L4"><code><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchC</span><span class="pun">.</span><span class="pln">searchResultsUpdater </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">searchC</span><span class="pun">.</span><span class="pln">dimsBackgroundDuringPresentation </span><span class="pun">=</span><span class="pln"> NO</span><span class="pun">;</span></code></li><li class="L6"><code><span class="com">// 用一个数组来装搜索的结果</span></code></li><li class="L7"><code><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchArr </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[@[]</span><span class="pln"> mutableCopy</span><span class="pun">];</span></code></li></ol></pre><p data-anchor-id="t0ou">实现代理方法<code>updateSearchResultsForSearchController</code></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7bkb"><ol class="linenums"><li class="L0"><code><span class="com">// 这里能获取每次输入的文字，需要对数据进行过滤</span></code></li><li class="L1"><code><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln">updateSearchResultsForSearchController</span><span class="pun">:(</span><span class="typ">UISearchController</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">searchController</span></code></li><li class="L2"><code><span class="pun">{</span></code></li><li class="L3"><code><span class="pln">    </span><span class="pun">[</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchArr removeAllObjects</span><span class="pun">];</span></code></li><li class="L4"><code><span class="pln">    </span><span class="typ">NSLog</span><span class="pun">(@</span><span class="str">"%@"</span><span class="pun">,</span><span class="pln">searchController</span><span class="pun">.</span><span class="pln">searchBar</span><span class="pun">.</span><span class="pln">text</span><span class="pun">);</span></code></li><li class="L5"><code><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">AddressModel</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> model </span><span class="kwd">in</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">addressModelArr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">([</span><span class="pln">model</span><span class="pun">.</span><span class="pln">name containsString</span><span class="pun">:</span><span class="pln">searchController</span><span class="pun">.</span><span class="pln">searchBar</span><span class="pun">.</span><span class="pln">text</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code><span class="pln">            </span><span class="pun">[</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchArr addObject</span><span class="pun">:</span><span class="pln">model</span><span class="pun">];</span></code></li><li class="L8"><code><span class="pln">        </span><span class="pun">}</span></code></li><li class="L9"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code><span class="pln">    </span><span class="pun">[</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">tableView reloadData</span><span class="pun">];</span></code></li><li class="L1"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="4uj9">tableView的数据源代理方法如下 注意<code>isActive</code>属性</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ls2u"><ol class="linenums"><li class="L0"><code><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="typ">NSInteger</span><span class="pun">)</span><span class="pln">tableView</span><span class="pun">:(</span><span class="typ">UITableView</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">tableView numberOfRowsInSection</span><span class="pun">:(</span><span class="typ">NSInteger</span><span class="pun">)</span><span class="pln">section</span></code></li><li class="L1"><code><span class="pun">{</span></code></li><li class="L2"><code><span class="pln">   </span><span class="com">// isActive用来区分SearchController是否在用</span></code></li><li class="L3"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchC</span><span class="pun">.</span><span class="pln">isActive </span><span class="pun">?</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchArr</span><span class="pun">.</span><span class="pln">count </span><span class="pun">:</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">addressModelArr</span><span class="pun">.</span><span class="pln">count</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pun">}</span></code></li><li class="L5"><code></code></li><li class="L6"><code><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="typ">UITableViewCell</span><span class="pun">*)</span><span class="pln">tableView</span><span class="pun">:(</span><span class="typ">UITableView</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">tableView cellForRowAtIndexPath</span><span class="pun">:(</span><span class="typ">NSIndexPath</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">indexPath</span></code></li><li class="L7"><code><span class="pun">{</span></code></li><li class="L8"><code><span class="pln">    </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">NSString</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> ID </span><span class="pun">=</span><span class="pln"> </span><span class="pun">@</span><span class="str">"UITableViewCellStyleDefault"</span><span class="pun">;</span></code></li><li class="L9"><code><span class="pln">    </span><span class="typ">UITableViewCell</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cell </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">tableView dequeueReusableCellWithIdentifier</span><span class="pun">:</span><span class="pln">ID</span><span class="pun">];</span></code></li><li class="L0"><code><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">cell</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code><span class="pln">        cell </span><span class="pun">=</span><span class="pln">  </span><span class="pun">[[</span><span class="typ">UITableViewCell</span><span class="pln"> alloc</span><span class="pun">]</span><span class="pln">initWithStyle</span><span class="pun">:</span><span class="typ">UITableViewCellStyleDefault</span><span class="pln"> reuseIdentifier</span><span class="pun">:</span><span class="pln">ID</span><span class="pun">];</span></code></li><li class="L2"><code></code></li><li class="L3"><code><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code><span class="pln">    </span><span class="typ">AddressModel</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> model </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchC</span><span class="pun">.</span><span class="pln">isActive</span><span class="pun">?</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">searchArr</span><span class="pun">[</span><span class="pln">indexPath</span><span class="pun">.</span><span class="pln">row</span><span class="pun">]:</span><span class="kwd">self</span><span class="pun">.</span><span class="pln">addressModelArr</span><span class="pun">[</span><span class="pln">indexPath</span><span class="pun">.</span><span class="pln">row</span><span class="pun">]</span><span class="pln"> </span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">    cell</span><span class="pun">.</span><span class="pln">imageView</span><span class="pun">.</span><span class="pln">image </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="typ">UIImage</span><span class="pln"> imageNamed</span><span class="pun">:</span><span class="pln">model</span><span class="pun">.</span><span class="pln">headImg</span><span class="pun">];</span></code></li><li class="L6"><code><span class="pln">    cell</span><span class="pun">.</span><span class="pln">textLabel</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> model</span><span class="pun">.</span><span class="pln">name </span><span class="pun">;</span></code></li><li class="L7"><code><span class="pln">    </span><span class="kwd">return</span><span class="pln"> cell</span><span class="pun">;</span></code></li><li class="L8"><code></code></li><li class="L9"><code><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="sf3n">实现效果如下： <br>
<img src="http://static.zybuluo.com/zhuoming/fptgdgrie5vvk82bbda4fbws/xib29.gif" alt="xib29.gif-2496.4kB" title=""></p><div class="md-section-divider"></div><h2 data-anchor-id="qgz6" id="三课程作业"><strong>三、课程作业</strong></h2><blockquote data-anchor-id="l914" class="white-blockquote">
  <ul>
  <li>1.利用静态cell完善微信我和发现这两个界面</li>
  <li>2.用UISearchController实现通许录的搜索的效果</li>
  </ul>
</blockquote></div>
</body>
</html>